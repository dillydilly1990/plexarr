volumes:
  ts-state-prowlarr: null
  ts-state-lidarr: null
  ts-state-radarr: null
  ts-state-sonarr: null
services:
  lidarr-on-steroids:
    container_name: lidarr-on-steroids
    image: youegraillot/lidarr-on-steroids
    restart: unless-stopped
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - AUTOCONFIG=true
      - CLEAN_DOWNLOADS=true
      - FLAC2CUSTOM_ARGS=""
    volumes:
      - ${LSIO_APPDATA:?err}/lidarr-on-steroids:/config
      - ${LSIO_APPDATA:?err}/lidarr-on-steroids/deemix:/config_deemix
      - ${DOWNLOADS:?err}/deemix:/downloads
      - ${MEDIA:?err}/music:/music
    network_mode: container:gluetunVPN
    # Ports are disabled in containers when they are connected to VPN, as the
    # Gluetun container manages the ports for containers that connect via VPN
    #    ports:
    #      - "${WEBUI_PORT_LIDARR_ON_STEROIDS:?err}:8686"             # Configured in Gluetun VPN container
    #      - "${WEBUI_PORT_DEEMIX:?err}:6595"
  prowlarr:
    image: lscr.io/linuxserver/prowlarr:develop
    container_name: prowlarr
    restart: unless-stopped
    volumes:
      - ${LSIO_APPDATA:?err}/prowlarr:/config
      - ${LSIO_APPDATA:?err}/prowlarr/definitions/custom:/config/Definitions/Custom
      - ts-state-prowlarr:/var/lib/tailscale
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - DOCKER_MODS=${DOCKER_MODS:?err}|ghcr.io/themepark-dev/theme.park:prowlarr
      - TP_THEME=${TP_THEME:?err}
      - TAILSCALE_SERVE_PORT=8686
      - TAILSCALE_SERVE_MODE=https
      - TAILSCALE_USE_SSH=1
      - TAILSCALE_HOSTNAME=prowlarr
      - TAILSCALE_AUTHKEY=${TS_KEY_PROWLARR:?err}
      - TAILSCALE_STATE_DIR=/var/lib/tailscale
      - TS_EXTRA_ARGS=${TS_EX_ARGS}
    network_mode: container:gluetunVPN
    # Ports are disabled in containers when they are connected to VPN, as the
    # Gluetun container manages the ports for containers that connect via VPN
    #    ports:
    #      - "${WEBUI_PORT_PROWLARR:?err}:9696"             # Configured in Gluetun VPN container
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.webui=http://192.168.0.69:9696
      - net.unraid.docker.icon=https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/prowlarr-logo.png
    networks: []
  lidarr:
    image: lscr.io/linuxserver/lidarr:develop
    container_name: lidarr
    restart: unless-stopped
    volumes:
      - ${LSIO_APPDATA:?err}/lidarr:/config
      - ${LSIO_APPDATA:?err}/lidarr/custom-services.d:/custom-services.d
      - ${LSIO_APPDATA:?err}/lidarr/custom-cont-init.d:/custom-cont-init.d
      - ${MEDIA:?err}:/data
      - ts-state-lidarr:/var/lib/tailscale
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - DOCKER_MODS=${DOCKER_MODS:?err}|ghcr.io/themepark-dev/theme.park:lidarr
      - TP_THEME=${TP_THEME:?err}
      - TAILSCALE_SERVE_PORT=8686
      - TAILSCALE_SERVE_MODE=https
      - TAILSCALE_USE_SSH=1
      - TAILSCALE_HOSTNAME=lidarr
      - TAILSCALE_AUTHKEY=${TS_KEY_LIDARR:?err}
      - TS_EXTRA_ARGS=${TS_EX_ARGS}
      - TAILSCALE_STATE_DIR=/var/lib/tailscale
    network_mode: container:gluetunVPN
    # Ports are disabled in containers when they are connected to VPN, as the
    # Gluetun container manages the ports for containers that connect via VPN
    #    ports:
    #      - "${WEBUI_PORT_LIDARR:?err}:8686"             # Configured in Gluetun VPN container
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.webui=http://192.168.0.69:8686
      - net.unraid.docker.icon=https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/lidarr-logo.png
    networks: []
  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    restart: unless-stopped
    volumes:
      - ${LSIO_APPDATA:?err}/radarr:/config
      - ${LSIO_APPDATA:?err}/radarr/custom-services.d:/custom-services.d
      - ${LSIO_APPDATA:?err}/radarr/custom-cont-init.d:/custom-cont-init.d
      - ${MEDIA:?err}:/data
      - ts-state-radarr:/var/lib/tailscale
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - DOCKER_MODS=${DOCKER_MODS:?err}|ghcr.io/themepark-dev/theme.park:radarr
      - TP_THEME=${TP_THEME:?err}
      - TAILSCALE_SERVE_PORT=8686
      - TAILSCALE_SERVE_MODE=https
      - TAILSCALE_USE_SSH=1
      - TAILSCALE_HOSTNAME=radarr
      - TAILSCALE_AUTHKEY=${TS_KEY_RADARR:?err}
      - TS_EXTRA_ARGS=${TS_EX_ARGS}
      - TAILSCALE_STATE_DIR=/var/lib/tailscale
    network_mode: container:gluetunVPN
    # Ports are disabled in containers when they are connected to VPN, as the
    # Gluetun container manages the ports for containers that connect via VPN
    #    ports:
    #      - "${WEBUI_PORT_RADARR:?err}:7878"             # Configured in Gluetun VPN container
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.webui=http://192.168.0.69:7878
      - net.unraid.docker.icon=https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/radarr-logo.png
    networks: []
  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    restart: unless-stopped
    volumes:
      - ${LSIO_APPDATA:?err}/sonarr:/config
      - ${LSIO_APPDATA:?err}/sonarr/custom-services.d:/custom-services.d
      - ${LSIO_APPDATA:?err}/sonarr/custom-cont-init.d:/custom-cont-init.d
      - ${MEDIA:?err}:/data
      - ts-state-sonarr:/var/lib/tailscale
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - DOCKER_MODS=${DOCKER_MODS:?err}|ghcr.io/themepark-dev/theme.park:sonarr
      - TP_THEME=${TP_THEME:?err}
      - TAILSCALE_SERVE_PORT=8686
      - TAILSCALE_SERVE_MODE=https
      - TAILSCALE_USE_SSH=1
      - TAILSCALE_HOSTNAME=sonarr
      - TAILSCALE_AUTHKEY=${TS_KEY_SONARR:?err}
      - TS_EXTRA_ARGS=${TS_EX_ARGS}
      - TAILSCALE_STATE_DIR=/var/lib/tailscale
    network_mode: container:gluetunVPN
    # Ports are disabled in containers when they are connected to VPN, as the
    # Gluetun container manages the ports for containers that connect via VPN
    #    ports:
    #      - "${WEBUI_PORT_SONARR:?err}:8989"             # Configured in Gluetun VPN container
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.webui=http://192.168.0.69:8989
      - net.unraid.docker.icon=https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/sonarr-logo.png
    networks: []
  flaresolverr:
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    restart: unless-stopped
    volumes:
      - ${LSIO_APPDATA:?err}/prowlarr/flaresolver:/config
    environment:
      - LOG_LEVEL=info
      - LOG_HTML=false
      - CAPTCHA_SOLVER=none
      - TZ=${TIMEZONE:?err}
    network_mode: contanetworks:
  vpn:
    name: vpn
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: ${DOCKER_SUBNET:?err}
          gateway: ${DOCKER_GATEWAY:?err}
services:
  ###########################################################################
  ###########################################################################
  ##
  ##  Docker Compose File: Gluetun (qmcgaw)
  ##  Function: VPN Client
  ##
  ##  Documentation: https://github.com/qdm12/gluetun/wiki
  ##
  ###########################################################################
  ###########################################################################
  vpn:
    image: qmcgaw/gluetun:latest
    container_name: gluetunVPN
    restart: always
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun:/dev/net/tun
    ports:
      #ARRS
      - ${WEBUI_PORT_PROWLARR:?err}:9696 # WebUI Portal: Prowlarr
      - ${WEBUI_PORT_LIDARR:?err}:8687 # WebUI Portal: Lidarr
      - ${WEBUI_PORT_LIDARR_ON_STEROIDS:?err}:8686
      - ${WEBUI_PORT_DEEMIX:?err}:6595
      - ${WEBUI_PORT_RADARR:?err}:7878 # WebUI Portal: Radarr
      - ${WEBUI_PORT_SONARR:?err}:8989 # WebUI Portal: Sonarr
      #Plex
      - ${WEBUI_PORT_PLEX:?err}:32400 # WebUI Portal: Plex
      - 1900:1900/udp # DNLA Service
      - 5343:5343/udp # Plex Network Port
      - 8324:8324 # Plex Network Port
      - 32410:32410/udp # Plex Network Port
      - 32412:32412/udp # Plex Network Port
      - 32413:32413/udp # Plex Network Port
      - 32414:32414/udp # Plex Network Port
      - 32469:32469 # Plex Network Port
      #Gluetun
      - 8888:8888/tcp # Gluetun Local Network HTTP proxy
      - 8388:8388/tcp # Gluetun Local Network Shadowsocks
      - 8388:8388/udp # Gluetun Local Network Shadowsocks
    volumes:
      - ${networkDATA:?err}/gluetun:/gluetun:rw
    environment:
      - PUID=${PUID:?err}
      - PGID=${PGID:?err}
      - TZ=${TIMEZONE:?err}
      - LOG_LEVEL=info
      - VPN_SERVICE_PROVIDER=${VPN_SERVICE_PROVIDER:?err}
      - VPN_TYPE=${VPN_TYPE}
      - WIREGUARD_IMPLEMENTATION=auto
      - WIREGUARD_ENDPOINT_IP=${WIREGUARD_ENDPOINT_IP}
      - WIREGUARD_ENDPOINT_PORT=${WIREGUARD_ENDPOINT_PORT}
      - WIREGUARD_PUBLIC_KEY=${WIREGUARD_PUBLIC_KEY}
      - WIREGUARD_PRIVATE_KEY=${WIREGUARD_PRIVATE_KEY}
      - WIREGUARD_PRESHARED_KEY=${WIREGUARD_PRESHARED_KEY}
      - WIREGUARD_ADDRESSES=${WIREGUARD_ADDRESSES}
      - OPENVPN_ENDPOINT_IP=
      - OPENVPN_ENDPOINT_PORT=
      - OPENVPN_USER=${VPN_USERNAME:?err}
      - OPENVPN_PASSWORD=${VPN_PASSWORD:?err}
      - OPENVPN_CUSTOM_CONFIG=${OPENVPN_CUSTOM_CONFIG}
      - OPENVPN_VERSION=2.5
      - OPENVPN_VERBOSITY=1
      - OPENVPN_FLAGS=
      - OPENVPN_CIPHERS=
      - OPENVPN_AUTH=
      - OPENVPN_PROCESS_USER=
      - OPENVPN_IPV6=
      - SERVER_COUNTRIES=${SERVER_COUNTRIES}
      - SERVER_REGIONS=${SERVER_REGIONS}
      - SERVER_CITIES=${SERVER_CITIES}
      - SERVER_HOSTNAMES=${SERVER_HOSTNAMES}
      - SERVER_CATEGORIES=${SERVER_CATEGORIES}
      - FIREWALL=on
      - FIREWALL_VPN_INPUT_PORTS=
      - FIREWALL_INPUT_PORTS=
      - FIREWALL_DEBUG=off
      - FIREWALL_OUTBOUND_SUBNETS=${LOCAL_SUBNET:?err}
      - DOT=off
      - DOT_PROVIDERS=cloudflare
      - DOT_PRIVATE_ADDRESS=127.0.0.1/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16,::1/128,fc00::/7,fe80::/10,::ffff:7f00:1/104,::ffff:a00:0/104,::ffff:a9fe:0/112,::ffff:ac10:0/108,::ffff:c0a8:0/112
      - DOT_VERBOSITY=1
      - DOT_VERBOSITY_DETAILS=0
      - DOT_VALIDATION_LOGLEVEL=0
      - DOT_CACHING=on
      - DOT_IPV6=off
      - BLOCK_MALICIOUS=on
      - BLOCK_SURVEILLANCE=off
      - BLOCK_ADS=off
      - UNBLOCK=
      - DNS_UPDATE_PERIOD=24h
      - DNS_ADDRESS=
      - DNS_KEEP_NAMESERVER=off
      - HTTPPROXY=on
      - HTTPPROXY_LOG=off
      - HTTPPROXY_USER=
      - HTTPPROXY_PASSWORD=
      - HTTPPROXY_STEALTH=off
      - SHADOWSOCKS=on
      - SHADOWSOCKS_LOG=off
      - SHADOWSOCKS_PASSWORD=
      - SHADOWSOCKS_CIPHER=chacha20-ietf-poly1305
      - HEALTH_SERVER_ADDRESS=127.0.0.1:9999
      - HEALTH_TARGET_ADDRESS=github.com:443
      - HEALTH_VPN_DURATION_INITIAL=6s
      - HEALTH_VPN_DURATION_ADDITION=5s
      - UPDATER_PERIOD=0
      - PUBLICIP_FILE=/gluetun/ip
      - PUBLICIP_PERIOD=12h
      - VERSION_INFORMATION=on
      - HTTP_CONTROL_SERVER_LOG=on
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.webui=http://192.168.50.69:8000
      - net.unraid.docker.icon=https://raw.githubusercontent.com/qdm12/gluetun/master/doc/logo_256.png
    # NOTE: Gluetun VPN container MUST ONLY connect to the mediastack
    networks:
      - vpn

iner:gluetunVPN
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.icon=https://raw.githubusercontent.com/FlareSolverr/FlareSolverr/master/resources/flaresolverr_logo.png

# Ports are disabled in containers when they are connected to VPN, as the
# Gluetun container manages the ports for containers that connect via VPN

#    ports:
#      - "${FLARESOLVERR_PORT:?err}:8191"             # Configured in Gluetun VPN container
